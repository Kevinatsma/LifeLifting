<ng-container *ngIf="user">
  <main class="specialist-wrapper">
      
    <section class="action-toolbar-top" *ngIf="editShow">
        <div class="left">
          <button class="icon-button" (click)="goBack()">
              <i class="fa__icon fas fa-arrow-left"></i>
          </button>
        </div>
        <div class="right">
          <button class="icon-button" (click)="editUser()">
            <i class="fa__icon fas fa-check"></i>
          </button>

        </div>
      </section>

      <form [formGroup]="editUserForm" *ngIf="editShow">
        <div class="warning">
        </div>
        <section class="specialist-header">
          <div class="profile-picture">
            <div class="image-uploader" *ngIf="!downloadURL" [style.backgroundImage]="'url('+ user.photoURL +')'">
              <span *ngIf="!user.photoURL">
                {{ 'global.errors.no_photo' | translate }}
              </span>
              <app-file-upload-button [url]="url" (imageEvent)="receiveDownloadURL($event)"></app-file-upload-button>
            </div>
            <div class="image-uploader" *ngIf="downloadURL" [style.backgroundImage]="'url('+ downloadURL +')'">
              <app-file-upload-button [url]="url" (imageEvent)="receiveDownloadURL($event)"></app-file-upload-button>
            </div>
          </div>
          <div class="quick-info">
            <div class="top">
              <div class="display-name">
                <input class="h2" name="displayName" formControlName="displayName">
              </div>
              <input class="h5" placeholder="Which country?" name="country" formControlName="country">

              <p class="speciality">
                User ID: {{user.uid}}
              </p>
              <div class="icon-fact-container">
                <div class="fact">
                  <i class="fa__icon fas fa-transgender"></i>
                  <mat-select matInput placeholder="{{user.basicData.gender}}" [(value)]="selectedGender" formControlName="gender" 
                  panelClass="dropdown-regular" autocomplete="off" required *ngIf="user.basicData">
                    <mat-option *ngFor="let gender of genders" [value]="gender.value">{{ gender.viewValue | translate }}</mat-option>
                  </mat-select>
                  <mat-select matInput placeholder="Gender" [(value)]="selectedGender" formControlName="gender" 
                  panelClass="dropdown-regular" autocomplete="off" required *ngIf="!user.basicData">
                    <mat-option *ngFor="let gender of genders" [value]="gender.value">{{ gender.viewValue | translate }}</mat-option>
                  </mat-select>
                </div>
                <div class="fact">
                  <i class="fa__icon fas fa-user-ninja"></i>
                  <mat-select matInput placeholder="{{ specialist.firstName }} {{ specialist.lastName }}" 
                  [(value)]="selectedSpecialist" panelClass="dropdown-regular" formControlName="specialist" autocomplete="off" 
                  required name="specialist" *ngIf="specialist">
                    <mat-option disabled selected>{{specialist.firstName}}</mat-option>
                    <mat-option *ngFor="let specialist of specialists | async" 
                    [value]="specialist.specialistID"
                    > {{specialist.firstName}} {{specialist.lastName}}</mat-option>
                  </mat-select>
                  <mat-select matInput placeholder="Specialist" 
                  [(value)]="selectedSpecialist" panelClass="dropdown-regular" formControlName="specialist" autocomplete="off" 
                  required name="specialist" *ngIf="!specialist">
                    <mat-option *ngFor="let specialist of specialists | async" 
                    [value]="specialist.specialistID"
                    > {{specialist.firstName}} {{specialist.lastName}}</mat-option>
                  </mat-select>
                </div>
              </div>
            </div>

            <div class="bottom">
              <p class="tab">
                <input class="stat" type="number" name="packageChoice" maxlength="2" formControlName="packageChoice"
                placeholder="#">
                {{ 'pages.users.edit_user.package_choice' | translate }}
              </p>
              <p class="tab">
                <input class="stat" type="number" name="age" maxlength="2" formControlName="age"
                placeholder="#"
                >
                {{ 'global.words.age' | translate }}
              </p>
            </div>
          </div>
        </section>
  
        <section class="about">  
          <h5>{{user.displayName}}'s {{ 'pages.users.edit_user.main_goal' | translate }}</h5>
          <textarea matInput matTextareaAutosize formControlName="mainGoal"></textarea>
        </section>
  
        <section class="contact-language">
          <div class="contact-info">
            <h5 class="purple">
              {{ 'pages.users.edit_user.contact_info' | translate }}
            </h5>
            <ul class="contact-menu">
              <li>
                <i class="fa__icon far fa-envelope"></i>
                <input type="contact-item" name="email" formControlName="email">
              </li>
              <li>
                <i class="fa__icon fas fa-mobile-alt"></i>
                <input type="contact-item" name="phoneNumber" formControlName="phoneNumber">
              </li>
            </ul>
          </div>
        </section>

        <section class="switches">
          <h1 class="section-title">
            {{ 'pages.users.edit_user.user_status.title' | translate }}
          </h1>
          <div class="switch-container">
            <div>
              <h3>{{ 'pages.users.edit_user.user_status.general.title' | translate }}</h3>
              <div class="switch">
                <p class="card-text">
                  <mat-slide-toggle formControlName="signUpCompleted" (change)="onChange($event)">
                    <ng-container *ngIf="user.status.signUpCompleted">
                      {{ 'global.user.status.signup_completed' | translate }}
                    </ng-container>
                    <ng-container *ngIf="!user.status.signUpCompleted">
                      {{ 'global.user.status.signup_incomplete' | translate }}
                    </ng-container>
                  </mat-slide-toggle>
                </p>

                <p class="card-text">
                  <mat-slide-toggle formControlName="accepted" (change)="onChange($event)">
                    <ng-container *ngIf="user.status.accepted">
                      {{ 'global.user.status.accepted' | translate }}
                    </ng-container>
                    <ng-container *ngIf="!user.status.accepted">
                      {{ 'global.user.status.denied' | translate }}
                    </ng-container>
                  </mat-slide-toggle>
                </p>

                <p class="card-text">
                  <mat-slide-toggle formControlName="subscriptionValid" (change)="onChange($event)">
                    <ng-container *ngIf="!user.status.subscriptionValid">
                      {{ 'global.user.status.subscription_invalid' | translate }}
                    </ng-container>
                    <ng-container *ngIf="user.status.subscriptionValid">
                      {{ 'global.user.status.subscription_valid' | translate }}
                    </ng-container>
                  </mat-slide-toggle>
                </p>
              </div>
            </div>
            <div>
              <h3 class="section-title">
                {{ 'pages.users.edit_user.user_status.appointment.title' | translate }}
              </h3>
              <div class="switch">
                <p class="card-text">
                  <mat-slide-toggle formControlName="appointment" (change)="onChange($event)">
                    <ng-container *ngIf="user.status.appointment">
                      {{ 'global.user.status.appointment_requested' | translate }}
                    </ng-container>
                    <ng-container *ngIf="!user.status.appointment">
                      {{ 'global.user.status.appointment_not_requested' | translate }}
                    </ng-container>
                  </mat-slide-toggle>
                </p>

                <p class="card-text">
                  <mat-slide-toggle formControlName="appointmentAccepted" (change)="onChange($event)">
                    <ng-container *ngIf="user.status.appointmentAccepted">
                      {{ 'global.user.status.appointment_accepted' | translate }}
                    </ng-container>
                    <ng-container *ngIf="!user.status.appointmentAccepted">
                      {{ 'global.user.status.appointment_not_accepted' | translate }}
                    </ng-container>
                  </mat-slide-toggle>
                </p>

                <p class="card-text">
                  <mat-slide-toggle formControlName="appointmentCompleted" (change)="onChange($event)">
                    <ng-container *ngIf="user.status.appointmentCompleted">
                      {{ 'global.user.status.appointment_completed' | translate }}
                    </ng-container>
                    <ng-container *ngIf="!user.status.appointmentCompleted">
                      {{ 'global.user.status.appointment_not_completed' | translate }}
                    </ng-container>
                  </mat-slide-toggle>
                </p>
              </div>
            </div>
          </div>
        </section>
      </form>
      </main>
  
  </ng-container>
    
  <ng-container *ngIf="!user">
    <app-loading-spinner></app-loading-spinner>
  </ng-container>
  